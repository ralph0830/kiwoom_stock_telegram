# 📈 자동매매 시스템 사용설명서

키움증권 자동매매 시스템을 처음 사용하시는 분들을 위한 가이드입니다.

---

## 📋 목차

1. [프로그램 소개](#프로그램-소개)
2. [시작하기 전에](#시작하기-전에)
3. [설치 및 설정](#설치-및-설정)
4. [자동매매 시작하기](#자동매매-시작하기)
5. [자동매매 중지하기](#자동매매-중지하기)
6. [자주 묻는 질문](#자주-묻는-질문)
7. [문제 해결](#문제-해결)
8. [주의사항](#주의사항)

---

## 프로그램 소개

### 이 프로그램은 무엇인가요?

Telegram 채널에서 매수 신호를 자동으로 감지하여 **실시간 자동 매수**하고,
목표 수익률 도달 시 **자동 매도**하는 스마트 자동매매 시스템입니다.

### 주요 기능

✅ **실시간 매수 신호 감지**
- Telegram 채널의 "Ai 종목포착 시그널" 메시지를 0.1초 이내 감지
- 시장가 즉시 매수 또는 지정가 매수 선택 가능

✅ **스마트 자동 매도**
- 목표 수익률 도달 시 자동 익절 (기본: +1%)
- 손절 수익률 도달 시 자동 손절 (기본: -2.5%)
- 장마감 전 강제 청산 (기본: 15:19)

✅ **안전장치**
- 하루 1회만 매수 (과매수 방지)
- 매수 시간 제한 (08:50 ~ 12:10)
- 실시간 WebSocket 모니터링

✅ **편리한 웹 대시보드**
- 실시간 로그 확인
- 매매 기록 조회
- 시스템 상태 모니터링

---

## 시작하기 전에

### 필수 준비물

**1. 키움증권 계좌**
- 키움증권 OpenAPI 신청 필수
- 모의투자 또는 실전투자 선택 가능
- API KEY 발급받기: https://apiportal.kiwoom.com

**2. Telegram 계정**
- Telegram 앱 설치 (PC 또는 모바일)
- 전화번호 인증 완료
- API 개발자 등록: https://my.telegram.org/auth

**3. Windows PC**
- Windows 10 이상 (64비트)
- 최소 4GB RAM
- 인터넷 연결 필수

### API 발급 방법

**키움증권 OpenAPI**:
1. https://apiportal.kiwoom.com 접속
2. 회원가입 및 로그인
3. "나의 앱" → "앱 등록" 클릭
4. 앱 이름 입력 (예: 자동매매시스템)
5. `APP_KEY`와 `SECRET_KEY` 복사해두기

**Telegram API**:
1. https://my.telegram.org/auth 접속
2. 전화번호 입력 (+82로 시작, 예: +821012345678)
3. SMS 인증 코드 입력
4. "API development tools" 클릭
5. 앱 정보 입력:
   - App title: 자동매매
   - Short name: autotrading
6. `api_id`와 `api_hash` 복사해두기

---

## 설치 및 설정

### 1단계: 프로그램 압축 해제

1. 다운로드한 `stock_trading_v1.6.0_portable.zip` 파일을 우클릭
2. "압축 풀기" 또는 "모두 압축 풀기" 선택
3. 압축 해제 위치 선택 (예: `C:\자동매매\`)
4. 압축 해제 완료 후 폴더 열기

**결과**:
```
C:\자동매매\stock_trading_portable\
├── 설정하기.lnk            ← 이것 먼저 실행!
├── 자동매매 시작.lnk        ← 설정 후 실행
├── 사용설명서.txt
├── python\                  (건드리지 마세요)
├── app\                     (건드리지 마세요)
├── data\                    (자동 생성됨)
└── scripts\                 (건드리지 마세요)
```

### 2단계: 설정하기

1. **"설정하기.lnk" 더블클릭** (또는 `scripts/setup.bat` 실행)
2. 설정 창이 열리면 3개 탭에 정보 입력:

#### 📱 Telegram 설정 탭

- **API ID**: Telegram API 발급 시 받은 숫자 (예: 12345678)
- **API Hash**: Telegram API 발급 시 받은 문자열
- **세션 이름**: 아무거나 입력 (예: my_trading_session)
- **SOURCE 채널**: 매수 신호를 받을 Telegram 채널 URL
  - 예: `https://t.me/+AbCdEfGhIjKl`
- **TARGET 채널** (선택): 알림을 받을 채널 (없으면 비워두기)

#### 💼 키움증권 설정 탭

- **모의투자 사용**: 체크하면 모의투자, 해제하면 실전투자
- **실전투자 APP KEY**: 실전투자 API KEY 입력
- **실전투자 SECRET KEY**: 실전투자 SECRET KEY 입력
- **모의투자 APP KEY**: 모의투자 API KEY 입력
- **모의투자 SECRET KEY**: 모의투자 SECRET KEY 입력
- **계좌번호**: 8자리-2자리 형식 (예: 12345678-01)

#### 💰 매매 전략 탭

- **최대 투자금액**: 한 번에 투자할 최대 금액 (예: 2000000 = 200만원)
- **목표 수익률**: 자동 익절 수익률 (예: 1.0 = 1%)
- **매수 시작 시간**: 매수 가능 시작 시간 (예: 08:50)
- **매수 종료 시간**: 매수 가능 종료 시간 (예: 12:10)

**고급 설정** (기본값 사용 권장):
- 매수 주문 타입: `market` (시장가) 또는 `limit_plus_one_tick` (지정가)
- 손절 수익률: -2.5 (손절 기준, 예: -2.5%)
- 강제 청산 시간: 15:19 (장마감 11분 전)

3. 모든 정보 입력 완료 후 **"저장" 버튼** 클릭
4. "✅ 설정이 저장되었습니다!" 메시지 확인

---

## 자동매매 시작하기

### 1단계: Telegram 인증 (최초 1회만)

프로그램을 처음 실행하면 Telegram 인증이 필요합니다.

1. **"자동매매 시작.lnk" 더블클릭**
2. 검은 창 (터미널)이 열리고 안내 메시지 표시:
   ```
   ⚠️ Telegram 인증이 필요합니다.
   처음 실행 시 Telegram 전화번호 인증을 진행합니다.
   준비가 되면 아무 키나 누르세요...
   ```
3. **아무 키나 누르기** (예: Enter)
4. Telegram 인증 진행:
   - **전화번호 입력**: `+821012345678` 형식으로 입력
   - **SMS 인증 코드 입력**: Telegram 앱에서 받은 5자리 코드 입력
   - **2단계 비밀번호 입력** (설정한 경우): 비밀번호 입력
5. 인증 완료 메시지 확인:
   ```
   ✅ Telegram 로그인 성공!
   로그인 사용자: 홍길동 (@honggildong)
   ```

### 2단계: 자동매매 시작

인증이 완료되면 자동으로 진행됩니다:

1. 웹 브라우저가 자동으로 열립니다 (`http://localhost:8501`)
2. 자동매매 대시보드 화면 표시:
   - **실시간 로그 탭**: 매수/매도 로그 확인
   - **매매 기록 탭**: 오늘의 매매 결과
   - **시스템 정보 탭**: 현재 보유 종목 및 설정

3. "자동매매 시스템이 실행 중입니다" 확인

### 3단계: 매수 신호 대기

이제 프로그램이 자동으로 Telegram 채널을 모니터링합니다:

```
👀 매수 신호 모니터링 시작... (Ctrl+C로 종료)
```

**매수 신호가 오면**:
1. Telegram에서 "Ai 종목포착 시그널" 메시지 감지
2. 0.1초 이내 자동 매수 주문 실행
3. 웹 대시보드에 실시간 로그 표시:
   ```
   🎯 종목 포착! 시장가 즉시 매수를 시작합니다
   ✅ 시장가 매수 주문 성공!
   ```

### 4단계: 자동 매도 대기

매수 완료 후 자동으로 실시간 시세 모니터링 시작:

**익절** (목표 수익률 도달):
```
🎯 목표 수익률 1% 도달! 자동 매도를 시작합니다
✅ 지정가 매도 주문 성공!
```

**손절** (손절 수익률 도달):
```
🚨 손절 조건 도달! (-2.5% 이하)
✅ 시장가 매도 주문 성공! (손절)
```

**강제 청산** (15:19):
```
⏰ 강제 청산 시간 도달! (15:19)
💰 보유 종목을 100% 전량 시장가 매도합니다
✅ 강제 청산 완료!
```

---

## 자동매매 중지하기

### 방법 1: 바로가기 없음 (수동)

1. 터미널 창 (검은 창)을 찾습니다
2. `Ctrl + C` 키를 누릅니다
3. 프로그램이 종료됩니다

### 방법 2: 작업 관리자 (강제 종료)

1. `Ctrl + Shift + Esc` 눌러 작업 관리자 열기
2. "프로세스" 탭에서 `python.exe` 찾기
3. 우클릭 → "작업 끝내기"

**⚠️ 주의**: 매수 완료 후 프로그램을 종료하면 자동 매도가 되지 않습니다!

---

## 자주 묻는 질문

### Q1. 매수는 됐는데 프로그램을 껐어요. 매도는 어떻게 하나요?

**A**: 걱정하지 마세요! 프로그램을 다시 실행하면 자동으로 매도 모니터링이 시작됩니다.

1. "자동매매 시작.lnk" 다시 실행
2. 프로그램이 계좌 잔고를 확인
3. 보유 종목이 있으면 자동으로 매도 모니터링 시작
4. 목표 수익률 도달 시 자동 매도

### Q2. 하루에 여러 번 매수할 수 있나요?

**A**: 아니요. 안전장치로 **하루 1회만** 매수됩니다.

- 이유: 과매수 방지 및 리스크 관리
- 다음날 자동으로 초기화되어 다시 매수 가능

### Q3. 목표 수익률을 변경하려면?

**A**: "설정하기.lnk" 다시 실행 → 매매 전략 탭 → 목표 수익률 변경 → 저장

- 변경 사항은 **다음 실행부터** 적용됩니다
- 이미 매수한 종목은 기존 설정으로 매도됩니다

### Q4. 모의투자와 실전투자를 어떻게 전환하나요?

**A**: "설정하기.lnk" → 키움증권 탭 → "모의투자 사용" 체크박스 변경 → 저장

- 체크: 모의투자
- 해제: 실전투자

**⚠️ 주의**: 실전투자는 실제 돈이 거래됩니다!

### Q5. Telegram 재인증이 필요하다고 나와요.

**A**: 시간이 지나거나 세션이 만료되면 재인증이 필요합니다.

1. 웹 대시보드에서 "Telegram 재인증" 버튼 클릭
2. 전화번호, SMS 코드, 비밀번호 입력
3. "인증하기" 버튼 클릭
4. 인증 완료 후 프로그램 재시작

### Q6. 웹 브라우저를 닫으면 자동매매가 중지되나요?

**A**: 아니요! 웹 브라우저는 **모니터링 화면만** 제공합니다.

- 브라우저를 닫아도 자동매매는 계속 실행됩니다
- 다시 보려면 `http://localhost:8501` 접속

### Q7. 다른 컴퓨터에서도 실행할 수 있나요?

**A**: 네! 하지만 설정과 세션 파일을 옮겨야 합니다.

1. `data/` 폴더 전체를 USB에 복사
2. 다른 컴퓨터에 프로그램 설치
3. `data/` 폴더 붙여넣기
4. 실행

**⚠️ 주의**: 동시에 2대 이상에서 실행하면 Telegram 세션이 끊길 수 있습니다.

---

## 문제 해결

### 🚨 "설정 파일이 없습니다!"

**원인**: "설정하기.lnk"를 실행하지 않았거나 설정 저장 실패

**해결**:
1. "설정하기.lnk" 실행
2. 모든 필수 항목 입력
3. "저장" 버튼 클릭
4. 저장 완료 메시지 확인

### 🚨 "Telegram 인증 실패!"

**원인**: 전화번호, SMS 코드, 비밀번호 오류

**해결**:
1. 전화번호 형식 확인: `+821012345678` (국가번호 포함)
2. SMS 코드 재전송 (Telegram 앱에서)
3. 2단계 비밀번호 확인 (설정한 경우)
4. API ID와 API Hash 재확인

### 🚨 "매수 주문 실패!"

**원인**: 계좌 잔고 부족, API KEY 오류, 시장 마감

**해결**:
1. 계좌 잔고 확인 (최대 투자금액보다 많아야 함)
2. API KEY와 SECRET KEY 재확인
3. 모의투자/실전투자 설정 확인
4. 매수 가능 시간 확인 (08:50 ~ 12:10)
5. 키움증권 서버 상태 확인

### 🚨 "웹 브라우저가 열리지 않아요"

**원인**: 포트 충돌 (8501 포트 사용 중)

**해결**:
1. 수동으로 브라우저 열기
2. 주소창에 `http://localhost:8501` 입력
3. Enter 키

### 🚨 "Windows의 PC 보호" 경고

**원인**: SmartScreen 보안 기능

**해결**:
1. "추가 정보" 클릭
2. "실행" 버튼 클릭

---

## 주의사항

### ⚠️ 투자 리스크

- 본 프로그램은 **투자 도구**일 뿐이며, 수익을 보장하지 않습니다
- 모든 투자 결과는 **사용자 본인의 책임**입니다
- 투자 전 **충분한 학습과 검토** 필요
- 처음에는 **모의투자**로 테스트 권장

### ⚠️ 보안 주의

- `.env` 파일에 **API 키가 저장**되므로 타인에게 공유 금지
- `data/` 폴더에 **Telegram 세션**이 저장되므로 보안 유지
- 공용 컴퓨터에서 사용 금지
- 정기적으로 `trading_results/` 백업 권장

### ⚠️ 시스템 안정성

- 프로그램 실행 중 **컴퓨터 절전 모드** 비활성화
- 안정적인 **인터넷 연결** 필수
- Windows 업데이트로 인한 재부팅 주의
- 중요한 매매 시간에는 **컴퓨터 앞에서 모니터링** 권장

### ⚠️ 법적 책임

- 키움증권 OpenAPI 이용약관 준수
- Telegram API 이용약관 준수
- 불법 시세 조작, 내부자 거래 금지
- 타인의 계좌 무단 사용 금지

---

## 문의 및 지원

### 기술 지원

- **이메일**: your-email@example.com
- **GitHub Issues**: [프로젝트 URL]
- **사용자 커뮤니티**: [텔레그램 그룹 URL]

### 업데이트 확인

- **현재 버전**: v1.6.0
- **최신 버전 확인**: [GitHub Releases URL]

### 피드백

프로그램 개선을 위한 의견이나 버그 리포트는 언제든 환영합니다!

---

**즐거운 자동매매 되세요! 📈💰**

---

**작성일**: 2025-11-10
**버전**: v1.6.0
**작성자**: Ralph
